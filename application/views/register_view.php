<!DOCTYPE html>

<!--[if IEMobile 7]><html class="no-js iem7 oldie linen"><![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js ie7 oldie linen" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js ie8 oldie linen" lang="en"><![endif]-->
<!--[if (IE 9)&!(IEMobile)]><html class="no-js ie9 linen" lang="en"><![endif]-->
<!--[if (gt IE 9)|(gt IEMobile 7)]><!--><html class="no-js linen" lang="en"><!--<![endif]-->

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>Inscripton - DGI</title>
	<meta name="description" content="">
	<meta name="author" content="">

	<!-- http://davidbcalhoun.com/2010/viewport-metatag -->
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">

	<!-- http://www.kylejlarson.com/blog/2012/iphone-5-web-design/ and http://darkforge.blogspot.fr/2010/05/customize-android-browser-scaling-with.html -->
	<meta name="viewport" content="user-scalable=0, initial-scale=1.0, target-densitydpi=115">

	<!-- For all browsers -->
	<link rel="stylesheet" href="<?php echo base_url();?>assets/css/reset.css?v=1">
	<link rel="stylesheet" href="<?php echo base_url();?>assets/css/style.css?v=1">
	<link rel="stylesheet" href="<?php echo base_url();?>assets/css/colors.css?v=1">
	<link rel="stylesheet" media="print" href="<?php echo base_url();?>assets/css/print.css?v=1">
	<!-- For progressively larger displays -->
	<link rel="stylesheet" media="only all and (min-width: 480px)" href="<?php echo base_url();?>assets/css/480.css?v=1">
	<link rel="stylesheet" media="only all and (min-width: 768px)" href="<?php echo base_url();?>assets/css/768.css?v=1">
	<link rel="stylesheet" media="only all and (min-width: 992px)" href="<?php echo base_url();?>assets/css/992.css?v=1">
	<link rel="stylesheet" media="only all and (min-width: 1200px)" href="<?php echo base_url();?>assets/css/1200.css?v=1">
	<!-- For Retina displays -->
	<link rel="stylesheet" media="only all and (-webkit-min-device-pixel-ratio: 1.5), only screen and (-o-min-device-pixel-ratio: 3/2), only screen and (min-device-pixel-ratio: 1.5)" href="css/2x.css?v=1">

	<!-- Additional styles -->
	<link rel="stylesheet" href="<?php echo base_url();?>assets/css/styles/form.css?v=1">
	<link rel="stylesheet" href="<?php echo base_url();?>assets/css/styles/modal.css?v=1">
	<link rel="stylesheet" href="<?php echo base_url();?>assets/css/styles/progress-slider.css?v=1">
	<link rel="stylesheet" href="<?php echo base_url();?>assets/css/styles/switches.css?v=1">

	<!-- jQuery Form Validation -->
	<link rel="stylesheet" href="<?php echo base_url();?>assets/js/libs/formValidator/developr.validationEngine.css?v=1">

	<!--glDatePicker -->
	<link rel="stylesheet" href="<?php echo base_url();?>assets/js/libs/glDatePicker/developr.fixed.css?v=1">


	<!-- JavaScript at bottom except for Modernizr -->
	<script src="<?php echo base_url();?>assets/js/libs/modernizr.custom.js"></script>

	<!-- For Modern Browsers -->
	<link rel="shortcut icon" href="<?php echo base_url();?>assets/img/favicons/favicon.png">
	<!-- For everything else -->
	<link rel="shortcut icon" href="<?php echo base_url();?>assets/img/favicons/favicon.ico">

	<!-- iOS web-app metas -->
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">

	<!-- iPhone ICON -->
	<link rel="apple-touch-icon" href="<?php echo base_url();?>assets/img/favicons/apple-touch-icon.png" sizes="57x57">
	<!-- iPad ICON -->
	<link rel="apple-touch-icon" href="<?php echo base_url();?>assets/img/favicons/apple-touch-icon-ipad.png" sizes="72x72">
	<!-- iPhone (Retina) ICON -->
	<link rel="apple-touch-icon" href="<?php echo base_url();?>assets/img/favicons/apple-touch-icon-retina.png" sizes="114x114">
	<!-- iPad (Retina) ICON -->
	<link rel="apple-touch-icon" href="<?php echo base_url();?>assets/img/favicons/apple-touch-icon-ipad-retina.png" sizes="144x144">

	<!-- iPhone SPLASHSCREEN (320x460) -->
	<link rel="apple-touch-startup-image" href="<?php echo base_url();?>assets/img/splash/iphone.png" media="(device-width: 320px)">
	<!-- iPhone (Retina) SPLASHSCREEN (640x960) -->
	<link rel="apple-touch-startup-image" href="<?php echo base_url();?>assets/img/splash/iphone-retina.png" media="(device-width: 320px) and (-webkit-device-pixel-ratio: 2)">
	<!-- iPhone 5 SPLASHSCREEN (640×1096) -->
	<link rel="apple-touch-startup-image" href="<?php echo base_url();?>assets/img/splash/iphone5.png" media="(device-height: 568px) and (-webkit-device-pixel-ratio: 2)">
	<!-- iPad (portrait) SPLASHSCREEN (748x1024) -->
	<link rel="apple-touch-startup-image" href="<?php echo base_url();?>assets/img/splash/ipad-portrait.png" media="(device-width: 768px) and (orientation: portrait)">
	<!-- iPad (landscape) SPLASHSCREEN (768x1004) -->
	<link rel="apple-touch-startup-image" href="<?php echo base_url();?>assets/img/splash/ipad-landscape.png" media="(device-width: 768px) and (orientation: landscape)">
	<!-- iPad (Retina, portrait) SPLASHSCREEN (2048x1496) -->
	<link rel="apple-touch-startup-image" href="<?php echo base_url();?>assets/img/splash/ipad-portrait-retina.png" media="(device-width: 1536px) and (orientation: portrait) and (-webkit-min-device-pixel-ratio: 2)">
	<!-- iPad (Retina, landscape) SPLASHSCREEN (1536x2008) -->
	<link rel="apple-touch-startup-image" href="<?php echo base_url();?>assets/img/splash/ipad-landscape-retina.png" media="(device-width: 1536px)  and (orientation: landscape) and (-webkit-min-device-pixel-ratio: 2)">

	<!-- Microsoft clear type rendering -->
	<meta http-equiv="cleartype" content="on">

	<!-- IE9 Pinned Sites: http://msdn.microsoft.com/en-us/library/gg131029.aspx -->
	<meta name="application-name" content="Developr Admin Skin">
	<meta name="msapplication-tooltip" content="Cross-platform admin template.">
	<meta name="msapplication-starturl" content="http://www.display-inline.fr/demo/developr">
	<!-- These custom tasks are examples, you need to edit them to show actual pages -->
	<meta name="msapplication-task" content="name=Agenda;action-uri=http://www.display-inline.fr/demo/developr/agenda.html;icon-uri=http://www.display-inline.fr/demo/developr/img/favicons/favicon.ico">
	<meta name="msapplication-task" content="name=My profile;action-uri=http://www.display-inline.fr/demo/developr/profile.html;icon-uri=http://www.display-inline.fr/demo/developr/img/favicons/favicon.ico">
</head>

<body class="full-page-wizard">

	<form method="post" action="<?php echo base_url('add_card');?>" class="block wizard same-height" id="register">

		<h3 class="block-title">Assistant d'enregistrement<a href="<?php echo base_url('login')?>" class="float-right" title="Fermer"><span class="icon-cross icon-red icon-size3"></span></a></h3>


		<fieldset id="account_credentials" class="wizard-fieldset fields-list">

			<legend class="legend">La connexion</legend>

			<div class="field-block">
				<h2>Bienvenue à la DGI !</h2>
				<h5>S'il vous plaît, remplissez ce formulaire pour compléter votre enregistrement.</h5>
			</div>

			<div class="field-block button-height required">
				<label for="nif" class="label"><b>NIF:</b></label>
				<input type="text" name="nif" id="nif" value="" class="input validate[required]">
			</div>

			<div class="field-block button-height required">
				<label for="nom" class="label"><b>Nom:</b></label>
				<input type="text" name="nom" id="nom" value="" class="input validate[required]">
			</div>

			<div class="field-block button-height required">
				<label for="prenom" class="label"><b>Prenom:</b></label>
				<input type="text" name="prenom" id="prenom" value="" class="input validate[required]">

			</div>

			<div class="field-block button-height required">
				<label for="username" class="label"><b>Code Utilisateur:</b></label>
				<input type="text" name="username" id="username" value="" class="input validate[required]">
			</div>

			<div class="field-block button-height required">
				<label for="password" class="label"><b>Mot de Passe:</b></label>
				<input type="password" name="password" id="password" value="" class="input validate[required]">
			</div>

			<div class="field-block required">
				<label for="password2" class="label"><b>Répéter le Mot de Passe:</b></label>
				<input type="password" name="password2" id="password2" value="" class="input validate[required, equals[password]]">
			</div>




		</fieldset>

		<fieldset class="wizard-fieldset fields-list">

			<legend class="legend">Sur vous</legend>



			<div class="field-block button-height required">
				<label for="nina" class="label"><b>NINA</b></label>
				<input type="text" name="nina" id="nina" value="" class="input small-margin-right validate[required]">
							<span class="info-spot">
                                    <span class="icon-info-round"></span>
                                    <span class="info-bubble">
                                        Numéro d'Identification Nationale
                                    </span>
                                </span>

			</div>

			<div class="field-block button-height required">
				<label for="sexe" class="label"><b>Sexe</b></label>
				<select class="select blue-gradient check-list" name="sexe">
					<option value="Mâle">Mâle</option>
					<option value="Femelle">Femelle</option>


				</select>
			</div>


			<div class="field-block button-height required">
				<label for="date" class="label"><b>Date de Naissance</b></label>
				<span class="input">
							<span class="icon-calendar"></span>
							<input type="text" name="date" id="date" class="input-unstyled datepicker validate[required]" value="">
						</span>

                                        <span class="info-spot">
                                            <span class="icon-info-round"></span>
                                            <span class="info-bubble">
                                                Entrez votre Date de Naissance, format AAAA-MM-JJ.
                                            </span>
                                        </span>
			</div>

			<div class="field-block button-height required">
				<label for="lieu" class="label"><b>Lieu de Naissance</b></label>
				<input type="text" name="lieu" id="lieu" value="" class="input small-margin-right validate[required]">
							<span class="info-spot">
                                    <span class="icon-info-round"></span>
                                    <span class="info-bubble">
                                        Lieu de Naissance
                                    </span>
                                </span>

			</div>

			<div class="field-block required">
				<label for="situation_matrimoniale" class="label"><b>Situation Matrimoniale</b></label>
				<select class="select blue-gradient check-list" style="width: 180px;" name="situation_matrimoniale" id="situation_matrimoniale">
					<option value="Marié(e)" selected>Marié(e)</option>
					<option value="Veuf(ve)">Veuf(ve)</option>
					<option value="Séparé(e)">Séparé(e)</option>
					<option value="Divorcé(e)">Divorcé(e)</option>
					<option value="Célibataire">Célibataire</option>

				</select>
			</div>


			<div class="field-block button-height required">
				<label for="profession" class="label"><b>Mère</b></label>
				<input type="text" name="nom_mere" id="nom_mere" value="" class="input small-margin-right validate[required]" placeholder="Nom Mère">
				<input type="text" name="prenom_mere" id="prenom_mere" value="" class="input small-margin-right validate[required]" placeholder="Prenom Mère">
							<span class="info-spot">
                                    <span class="icon-info-round"></span>
                                    <span class="info-bubble">
                                        Nom et Prenom Mère
                                    </span>
                                </span>

			</div>

			<div class="field-block button-height required">
				<label for="profession" class="label"><b>Père</b></label>
				<input type="text" name="nom_pere" id="nom_pere" value="" class="input small-margin-right validate[required]" placeholder="Nom Père">
				<input type="text" name="prenom_pere" id="prenom_pere" value="" class="input small-margin-right validate[required]" placeholder="Prenom Père">
							<span class="info-spot">
                                    <span class="icon-info-round"></span>
                                    <span class="info-bubble">
                                        Nom et Prenom Père
                                    </span>
                                </span>

			</div>



		</fieldset>

		<fieldset class="wizard-fieldset fields-list">

			<legend class="legend">Contact</legend>

			<div class="field-block button-height required">
				<label for="email" class="label"><b>Courriel:</b></label>
				<input type="text" name="email" id="email" value="" class="input validate[required,custom[email]]">
			</div>

			<div class="field-block button-height required">
				<label for="telephone_mobile" class="label"><b>Téléphone Mobile:</b></label>
				<input type="text" name="telephone_mobile" id="telephone_mobile" value="" class="input small-margin-right validate[required]">
			</div>



			<div class="field-block button-height required">
				<span class="label"><b>Adresse:</b></span>
				
				<span class="icon-star red small small-margin-right" style="font-size: 7px;"></span>
				 <input type="text" name="commune" id="commune" value="" class="input small-margin-right input validate[required]" placeholder="Commune">
				 <span class="info-spot">
                                    <span class="icon-info-round"></span>
                                    <span class="info-bubble">
                                        Coomune.

                                    </span>

				 </span>
				<br>
				<span class="icon-star red small small-margin-right" style="font-size: 7px;"></span>
				<input type="text" name="quartier" id="quartier" value="" class="input small-margin-right input validate[required]" placeholder="Quartier">
								<span class="info-spot">
                                    <span class="icon-info-round"></span>
                                    <span class="info-bubble">
                                        Quartier
                                    </span>
                                </span>
				<br>
				<input type="text" name="immeuble" id="immeuble" value="" class="input small-margin-right" placeholder="Immeuble" style="margin-left:12px;">
								<span class="info-spot">
                                    <span class="icon-info-round"></span>
                                    <span class="info-bubble">
                                        Immeuble
                                    </span>
                                </span>
				<br>
				<input type="text" name="nom_rue" id="nom_rue" value="" class="input small-margin-right" placeholder="Nom Rue" style="margin-left:12px;">
								<span class="info-spot">
                                    <span class="icon-info-round"></span>
                                    <span class="info-bubble">
                                        Nom Rue.
                                    </span>
                                </span><br>
				<input type="text" name="numero_rue" id="numero_rue" value="" class="input small-margin-right" placeholder="Numero Rue" style="margin-left:12px;">
								<span class="info-spot">
                                    <span class="icon-info-round"></span>
                                    <span class="info-bubble">
                                        Numero Rue
                                    </span>
                                </span><br>
				<input type="text" name="numero_porte" id="numero_porte" value="" class="input small-margin-right" placeholder="Numero Porte" style="margin-left:12px;">
							<span class="info-spot">
                                    <span class="icon-info-round"></span>
                                    <span class="info-bubble">
                                        Numero Porte
                                    </span>
                                </span><br>


			</div>

		</fieldset>

		<fieldset class="wizard-fieldset fields-list">

			<legend class="legend">Profession</legend>

			<div class="field-block button-height">
				<label for="profession" class="label"><b>Profession</b></label>
				<input type="text" name="profession" id="profession" value="" class="input small-margin-right validate[required]" style="width:70%;">
							<span class="info-spot">
                                    <span class="icon-info-round"></span>
                                    <span class="info-bubble">
                                        Profession
                                    </span>
                                </span>

			</div>

			<div class="field-block button-height">
				<label for="activite" class="label"><b>Activité Principale</b></label>
				<input type="text" name="activite" id="activite" value="" class="input small-margin-right validate[required]" style="width:90%;">
							<span class="info-spot">
                                    <span class="icon-info-round"></span>
                                    <span class="info-bubble">
                                        Activité Principale
                                    </span>
                                </span>

			</div>


			<div class="field-block button-height">
				<span class="label"><b>Validation</b></span>


				<p class="wrapped relative with-padding" style="min-height: 65px">
					<span class="ribbon"><span class="ribbon-inner red-gradient glossy">Hey!</span></span>

						<input type="checkbox" name="check[]" id="check" value="mention" class="checkbox">
						<label for="notifications_mention">Je confirme que toute l'information son valide.</label>
				</p>
			</div>


			<div class="field-block button-height wizard-controls align-right">

				<button type="submit" class="button glossy mid-margin-right" id="mysubmit">
					<span class="button-icon"><span class="icon-tick"></span></span>
					Enregistrer
				</button>

			</div>

		</fieldset>

	</form>

	<!-- JavaScript at the bottom for fast page loading -->

	<!-- Scripts -->
	<script src="<?php echo base_url();?>assets/js/libs/jquery-1.10.2.min.js"></script>
	<script src="<?php echo base_url();?>assets/js/setup.js"></script>

	<!-- Template functions -->
	<script src="<?php echo base_url();?>assets/js/developr.input.js"></script>
	<script src="<?php echo base_url();?>assets/js/developr.message.js"></script>
	<script src="<?php echo base_url();?>assets/js/developr.notify.js"></script>
	<script src="<?php echo base_url();?>assets/js/developr.scroll.js"></script>
	<script src="<?php echo base_url();?>assets/js/developr.progress-slider.js"></script>
	<script src="<?php echo base_url();?>assets/js/developr.tooltip.js"></script>
	<script src="<?php echo base_url();?>assets/js/developr.wizard.js"></script>

	<!-- jQuery Form Validation -->
	<script src="<?php echo base_url();?>assets/js/libs/formValidator/jquery.validationEngine.js?v=1"></script>
	<script src="<?php echo base_url();?>assets/js/libs/formValidator/languages/jquery.validationEngine-fr.js?v=1"></script>

	<!-- date picker -->
	<script src="<?php echo base_url();?>assets/js/libs/glDatePicker/glDatePicker.js?v=1"></script>

	<!-- modals -->
	<script src="<?php echo base_url();?>assets/js/developr.modal.js"></script>
	<link rel="stylesheet" href="<?php echo base_url();?>assets/css/styles/modal.css">


	<script>

		$(document).ready(function()
		{

			// Date picker
			$('#date').glDatePicker({

				zIndex: 100,

				onClick: function(target, cell, date, data) {
					var month = date.getMonth()+1;
					target.val(date.getFullYear() + '-' +
							month + '-' +
							date.getDate());

					if(data != null) {
						alert(data.message + '\n' + date);
					}
				}


			});



			function mysubmit()
			{
				$('#register').submit();
			}

			$('#mysubmit').on('click', function(e){

				console.log($('#activite').val());
				e.preventDefault();
				if(!$('.checkbox').hasClass('checked') || $('#activite').val()=='' || $('#profession').val()=='')
				{
					openModal('S\'il vous plait,  Si toutes les informations sont correctes, cochez por le confirme.');

				}
				else {


					setTimeout(mysubmit, 10000);
					openLoadingModal();


				}

			});

				// Elements
			var form = $('.wizard'),

				// If layout is centered
				centered;

			var top = 298;
			var left = 256;

			$('.gldp-default').css('top', Math.max(top, top + Math.round($.template.viewportHeight-form.outerHeight())/2)+'px');
			$('.gldp-default').css('left', Math.max(left, left + Math.round($.template.viewportWidth-form.outerWidth())/2)+'px');



			// Handle resizing (mostly for debugging)
			function handleWizardResize()
			{
				centerWizard(false);
			};

			// Register and first call
			$(window).on('normalized-resize', handleWizardResize);

			/*
			 * Center function
			 * @param boolean animate whether or not to animate the position change
			 * @return void
			 */
			function centerWizard(animate)
			{
				form[animate ? 'animate' : 'css']({ marginTop: Math.max(0, Math.round(($.template.viewportHeight-30-form.outerHeight())/2))+'px' });


			};

			// Initial vertical adjust
			centerWizard(false);

			// Refresh position on change step
			form.on('wizardchange', function() { centerWizard(true); });



			// Validation
			if ($.validationEngine)
			{
				form.validationEngine();


			}


			$('#username').on('blur', function(){

				if(!check_username())
					if(!check_nif())
						$('.wizard-next').removeClass('disabled');

			});

			$('#nif').on('blur', function(){

				if(!check_nif())
					if(!check_username()) {
						$('.wizard-next').removeClass('disabled');
						$('.wizard-next').removeAttr("disabled");
					}


			});




			//check if there is someone already register in the database
			function check_username()
			{
				//check if username is in use
				var username = $("#username").val();
				var use = false; //by default it is assumed not in use

				if(username) {
					$.ajax({
						type: 'post',
						url: '<?php echo base_url("login_controller/is_username_in_use"); ?>',
						data: {
							username: username
						},
						dataType: 'json',
						async: false,
						success: function (response) {

							if (response.in_use) {

								showMessage(response.message);
								$('.wizard-next').addClass('disabled');
								$('.wizard-next').attr('disabled', 'disabled');

								$('#account_credentials').addClass('current active');
								$('#account_credentials').removeClass('completed');
								$('#account_credentials').siblings('fieldset').removeClass('current active');


								$('ul.wizard-steps').children('li').removeClass('current active');
								$('ul.wizard-steps').children().eq(0).addClass('current active');
								$('ul.wizard-steps').children().eq(0).removeClass('completed');

								use = true;
							}


						},
						error: function (error) {
							console.log(error.statusText);
						}

					})
				}

				return use;

			}

			function check_nif(){

				//check if username is in use
				var nif = $("#nif").val();
				var use = false;

				if(nif) {
					$.ajax({
						type: 'post',
						url: '<?php echo base_url("login_controller/is_nif_in_use"); ?>',
						data: {
							nif: nif
						},
						dataType: 'json',
						async: false,
						success: function (response) {

							if (response.in_use) {

								showMessage(response.message);
								$('.wizard-next').addClass('disabled');
								$('.wizard-next').attr('disabled', 'disabled');

								$('#account_credentials').addClass('current active');
								$('#account_credentials').removeClass('completed');
								$('#account_credentials').siblings('fieldset').removeClass('current active');


								$('ul.wizard-steps').children('li').removeClass('current active');
								$('ul.wizard-steps').children().eq(0).addClass('current active');
								$('ul.wizard-steps').children().eq(0).removeClass('completed');



								use = true;
							}

						},
						error: function (error) {
							console.log(error.statusText);
						}

					})
				}

				return use;
			}



		});


		// Demo modal
		function openModal(message)
		{
			$.modal({
				title: 'Confirmation',
				content: message
			});
		}

		function showMessage(message)
		{
			notify('Error: ', message, {
				icon: 'assets/img/demo/error.png'
			});
		}

		// Demo loading modal
		function openLoadingModal(e)
		{
			var timeout;

			$.modal({
				contentAlign: 'center',
				width: 240,
				title: 'Loading',
				closeOnBlur: false,
				content: '<div style="line-height: 25px; padding: 0 0 10px"><span id="modal-status">Contacting server...</span><br><span id="modal-progress">0%</span></div>',
				buttons: {},
				scrolling: false,
				actions: {},
				onOpen: function()
				{
					// Progress bar
					var progress = $('#modal-progress').progress(100, {
								size: 200,
								style: 'large',
								barClasses: ['anthracite-gradient', 'glossy'],
								stripes: true,
								darkStripes: false,
								showValue: false
							}),

					// Loading state
							loaded = 0,

					// Window
							win = $(this),

					// Status text
							status = $('#modal-status'),

					// Function to simulate loading
							simulateLoading = function()
							{
								++loaded;
								progress.setProgressValue(loaded+'%', true);
								if (loaded === 100)
								{
									progress.hideProgressStripes().changeProgressBarColor('green-gradient');
									status.text('Done!');
									/*win.getModalContentBlock().message('Content loaded!', {
									 classes: ['green-gradient', 'align-center'],
									 arrow: 'bottom'
									 });*/
									setTimeout(function() { win.closeModal(); }, 1500);
								}
								else
								{
									if (loaded === 1)
									{
										status.text('Loading data...');
										progress.changeProgressBarColor('blue-gradient');
									}
									else if (loaded === 25)
									{
										status.text('Loading assets (1/4)...');
									}
									else if (loaded === 45)
									{
										status.text('Loading assets (2/4)...');
									}
									else if (loaded === 85)
									{
										status.text('Loading assets (3/4)...');
									}
									else if (loaded === 92)
									{
										status.text('Loading assets (4/4)...');
									}

									timeout = setTimeout(simulateLoading, 50);
								}
							};

					// Start
					timeout = setTimeout(simulateLoading, 2000);

				},
				onClose: function()
				{
					// Stop simulated loading if needed
					clearTimeout(timeout);
				}
			});
		}











	</script>

</body>
</html>